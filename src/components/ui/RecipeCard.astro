---
/**
 * Horizontal Post Card Component - Clean & Streamlined
 */

import { getEntry } from "astro:content";
import { formatDate } from "../../core/blogLogic";

interface Props {
  post: any;
  size?: "large" | "medium";
}

const { post, size = "medium" } = Astro.props;

// Get category data
let category = null;
try {
  if (post.data.category) {
    const categoryId =
      typeof post.data.category === "string"
        ? post.data.category
        : post.data.category.id;
    category = await getEntry("categories", categoryId);
  }
} catch (error) {
  console.warn("Could not load category:", error);
}
---

<article
  class="rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group border"
  style="background: var(--surface-card); border-color: var(--border-light);"
  onmouseover="this.style.borderColor='var(--color-primary-light)'"
  onmouseout="this.style.borderColor='var(--border-light)'"
>
  <div class="flex flex-col sm:flex-row">
    {
      post.data.image?.url && (
        <div
          class={`relative overflow-hidden flex-shrink-0 ${size === "large" ? "sm:w-80 h-48 sm:h-56" : "sm:w-64 h-40 sm:h-48"}`}
        >
          <a href={`/blog/${post.id}`} class="block w-full h-full">
            <img
              src={post.data.image.url}
              alt={post.data.image.alt || post.data.title}
              loading="lazy"
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
            />

            {size === "large" && (
              <div class="absolute top-3 right-3">
                <span class="text-white px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-xs font-semibold shadow-sm" style="background: var(--color-primary);">
                  Featured
                </span>
              </div>
            )}
          </a>
        </div>
      )
    }

    <div class="p-4 sm:p-6 flex-1 flex flex-col justify-between min-h-0">
      <div>
        <div class="flex items-center gap-2 mb-3">
          <div class="w-1.5 h-1.5 rounded-full" style="background: var(--color-primary);"></div>
          <time
            class="text-xs font-medium uppercase tracking-wide" style="color: var(--text-muted);"
          >
            {formatDate(post.data.pubDate)}
          </time>
        </div>

        <h3
          class={`font-bold leading-tight mb-3 ${size === "large" ? "text-xl sm:text-2xl" : "text-lg sm:text-xl"}`}
          style="color: var(--text-primary); font-family: var(--font-heading);"
        >
          <a
            href={`/blog/${post.id}`}
            class="transition-colors duration-200"
            style="color: inherit;"
            onmouseover="this.style.color='var(--color-primary)'"
            onmouseout="this.style.color='inherit'"
            style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;"
          >
            {post.data.title}
          </a>
        </h3>

        {
          post.data.description && (
            <p
              class="text-sm leading-relaxed mb-4" style="color: var(--text-secondary);"
              style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;"
            >
              {post.data.description}
            </p>
          )
        }
      </div>

      <div>
        <a
          href={`/blog/${post.id}`}
          class="inline-flex items-center gap-2 font-semibold text-sm transition-colors duration-200 group/link"
          style="color: var(--color-primary);"
          onmouseover="this.style.color='var(--color-primary-dark)'"
          onmouseout="this.style.color='var(--color-primary)'"
        >
          <span>Read More</span>
          <svg
            class="w-4 h-4 transition-transform duration-200 group-hover/link:translate-x-1"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </div>
</article>
